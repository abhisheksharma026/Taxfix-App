2025-03-10 10:01:37.087 | INFO     | __main__:main:10 - Starting model service
2025-03-10 10:01:37.092 | INFO     | __main__:main:14 - Prediction: [1]
2025-03-10 10:02:01.636 | INFO     | __main__:main:10 - Starting model service
2025-03-10 10:02:01.641 | INFO     | __main__:main:14 - Prediction: [1]
2025-03-10 10:02:19.591 | INFO     | __main__:main:10 - Starting model service
2025-03-10 10:02:19.591 | INFO     | model_service:load_model:18 - Model catboost_model_v1.pkl not found
2025-03-10 10:02:19.591 | INFO     | collection:load_data:6 - Loading data from data/dataset.csv
2025-03-10 10:02:19.600 | INFO     | model:train_model:30 - Training model
2025-03-10 10:02:20.396 | INFO     | model:evaluate_model:47 - F1 score: 0.7694650301089473
2025-03-10 10:02:20.397 | INFO     | model:save_model:53 - Saving model into directory
2025-03-10 10:02:20.397 | INFO     | model_service:load_model:20 - Model catboost_model_v1.pkl trained and saved
2025-03-10 10:02:20.404 | INFO     | __main__:main:14 - Prediction: [1]
2025-03-10 11:50:50.354 | INFO     | __main__:main:10 - Starting model service
2025-03-10 11:50:50.369 | INFO     | __main__:main:14 - Prediction: [1]
2025-03-10 11:53:17.734 | INFO     | __main__:main:11 - Starting model service
2025-03-10 11:53:17.739 | INFO     | __main__:main:15 - Prediction: [1]
2025-03-10 11:53:17.741 | INFO     | __main__:main:21 - Prediction on test json: [1]
2025-03-10 11:53:43.310 | INFO     | __main__:main:11 - Starting model service
2025-03-10 11:53:43.314 | INFO     | __main__:main:15 - Prediction on test data from config: [1]
2025-03-10 11:53:43.317 | INFO     | __main__:main:21 - Prediction on test json: [1]
2025-03-10 11:54:08.448 | INFO     | __main__:main:11 - Starting model service
2025-03-10 11:54:08.452 | INFO     | __main__:main:15 - Prediction on test data from config: [1]
2025-03-10 11:54:08.454 | INFO     | __main__:main:21 - Prediction on test json: [1]
2025-03-10 15:14:31.490 | INFO     | __main__:main:12 - Starting model service
2025-03-10 15:14:31.495 | ERROR    | __main__:<module>:29 - An error has been caught in function '<module>', process 'MainProcess' (25508), thread 'MainThread' (8323484672):
Traceback (most recent call last):

> File "/Users/anotherbadcode/Downloads/TaxFix-App/runner.py", line 29, in <module>
    main()
    └ <function main at 0x104ca9800>

  File "/Users/anotherbadcode/Downloads/TaxFix-App/runner.py", line 15, in main
    pred = ml_svc.predict(pd.DataFrame(process_features([settings.test_data])))
           │      │       │  │         │                 │        └ {'age': 30, 'income': 45000, 'employment_type': 'full_time', 'marital_status': 'single', 'time_spent_on_platform': 120, 'numb...
           │      │       │  │         │                 └ Settings(model_dir=PosixPath('models'), model_filename='catboost_model_v1.pkl', model_path='models/catboost_model_v1.pkl', da...
           │      │       │  │         └ <function process_features at 0x1191f5120>
           │      │       │  └ <class 'pandas.core.frame.DataFrame'>
           │      │       └ <module 'pandas' from '/Users/anotherbadcode/Library/Caches/pypoetry/virtualenvs/taxfix-app-9B8dhDvo-py3.11/lib/python3.11/si...
           │      └ <function ModelService.predict at 0x13eb1e7a0>
           └ <model_service.ModelService object at 0x13e306150>

  File "/Users/anotherbadcode/Downloads/TaxFix-App/preparation.py", line 11, in process_features
    X['age'] = X['age'].astype(int)
    │          └ [{'age': 30, 'income': 45000, 'employment_type': 'full_time', 'marital_status': 'single', 'time_spent_on_platform': 120, 'num...
    └ [{'age': 30, 'income': 45000, 'employment_type': 'full_time', 'marital_status': 'single', 'time_spent_on_platform': 120, 'num...

TypeError: list indices must be integers or slices, not str
2025-03-10 15:16:52.695 | INFO     | __main__:main:12 - Starting model service
2025-03-10 15:16:52.696 | ERROR    | __main__:<module>:29 - An error has been caught in function '<module>', process 'MainProcess' (25628), thread 'MainThread' (8323484672):
Traceback (most recent call last):

> File "/Users/anotherbadcode/Downloads/TaxFix-App/runner.py", line 29, in <module>
    main()
    └ <function main at 0x1022f91c0>

  File "/Users/anotherbadcode/Downloads/TaxFix-App/runner.py", line 15, in main
    pred = ml_svc.predict(pd.DataFrame(process_features([settings.test_data])))
           │      │       │  │         │                 │        └ {'age': 30, 'income': 45000, 'employment_type': 'full_time', 'marital_status': 'single', 'time_spent_on_platform': 120, 'numb...
           │      │       │  │         │                 └ Settings(model_dir=PosixPath('models'), model_filename='catboost_model_v1.pkl', model_path='models/catboost_model_v1.pkl', da...
           │      │       │  │         └ <function process_features at 0x122921080>
           │      │       │  └ <class 'pandas.core.frame.DataFrame'>
           │      │       └ <module 'pandas' from '/Users/anotherbadcode/Library/Caches/pypoetry/virtualenvs/taxfix-app-9B8dhDvo-py3.11/lib/python3.11/si...
           │      └ <function ModelService.predict at 0x1305e2700>
           └ <model_service.ModelService object at 0x1305c8110>

  File "/Users/anotherbadcode/Downloads/TaxFix-App/preparation.py", line 11, in process_features
    X['age'] = X['age'].astype(int)
    │          └ [{'age': 30, 'income': 45000, 'employment_type': 'full_time', 'marital_status': 'single', 'time_spent_on_platform': 120, 'num...
    └ [{'age': 30, 'income': 45000, 'employment_type': 'full_time', 'marital_status': 'single', 'time_spent_on_platform': 120, 'num...

TypeError: list indices must be integers or slices, not str
2025-03-10 15:17:59.484 | INFO     | __main__:main:12 - Starting model service
2025-03-10 15:17:59.485 | ERROR    | __main__:<module>:29 - An error has been caught in function '<module>', process 'MainProcess' (25669), thread 'MainThread' (8323484672):
Traceback (most recent call last):

> File "/Users/anotherbadcode/Downloads/TaxFix-App/runner.py", line 29, in <module>
    main()
    └ <function main at 0x1024d11c0>

  File "/Users/anotherbadcode/Downloads/TaxFix-App/runner.py", line 15, in main
    pred = ml_svc.predict(pd.DataFrame(process_features([settings.test_data])))
           │      │       │  │         │                 │        └ {'age': 30, 'income': 45000, 'employment_type': 'full_time', 'marital_status': 'single', 'time_spent_on_platform': 120, 'numb...
           │      │       │  │         │                 └ Settings(model_dir=PosixPath('models'), model_filename='catboost_model_v1.pkl', model_path='models/catboost_model_v1.pkl', da...
           │      │       │  │         └ <function process_features at 0x11784d080>
           │      │       │  └ <class 'pandas.core.frame.DataFrame'>
           │      │       └ <module 'pandas' from '/Users/anotherbadcode/Library/Caches/pypoetry/virtualenvs/taxfix-app-9B8dhDvo-py3.11/lib/python3.11/si...
           │      └ <function ModelService.predict at 0x141e8a700>
           └ <model_service.ModelService object at 0x137439e10>

  File "/Users/anotherbadcode/Downloads/TaxFix-App/preparation.py", line 12, in process_features
    X = pd.DataFrame(X)
                     └ [{'age': 30, 'income': 45000, 'employment_type': 'full_time', 'marital_status': 'single', 'time_spent_on_platform': 120, 'num...

NameError: name 'pd' is not defined
2025-03-10 15:18:13.405 | INFO     | __main__:main:12 - Starting model service
2025-03-10 15:18:13.409 | ERROR    | __main__:<module>:29 - An error has been caught in function '<module>', process 'MainProcess' (25684), thread 'MainThread' (8323484672):
Traceback (most recent call last):

  File "/Users/anotherbadcode/Library/Caches/pypoetry/virtualenvs/taxfix-app-9B8dhDvo-py3.11/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           │    │               └ 'sessions_per_minute'
           │    └ <pandas._libs.properties.CachedProperty object at 0x121802840>
           └ Index(['age', 'income', 'employment_type', 'marital_status',
                    'time_spent_on_platform', 'number_of_sessions',
                    'f...
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item

KeyError: 'sessions_per_minute'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

> File "/Users/anotherbadcode/Downloads/TaxFix-App/runner.py", line 29, in <module>
    main()
    └ <function main at 0x1025a11c0>

  File "/Users/anotherbadcode/Downloads/TaxFix-App/runner.py", line 15, in main
    pred = ml_svc.predict(pd.DataFrame(process_features([settings.test_data])))
           │      │       │  │         │                 │        └ {'age': 30, 'income': 45000, 'employment_type': 'full_time', 'marital_status': 'single', 'time_spent_on_platform': 120, 'numb...
           │      │       │  │         │                 └ Settings(model_dir=PosixPath('models'), model_filename='catboost_model_v1.pkl', model_path='models/catboost_model_v1.pkl', da...
           │      │       │  │         └ <function process_features at 0x122af5080>
           │      │       │  └ <class 'pandas.core.frame.DataFrame'>
           │      │       └ <module 'pandas' from '/Users/anotherbadcode/Library/Caches/pypoetry/virtualenvs/taxfix-app-9B8dhDvo-py3.11/lib/python3.11/si...
           │      └ <function ModelService.predict at 0x13291e700>
           └ <model_service.ModelService object at 0x1323dd0d0>

  File "/Users/anotherbadcode/Downloads/TaxFix-App/preparation.py", line 25, in process_features
    X["sessions_per_minute"] = X["sessions_per_minute"].astype(float).astype(int)
    │                          └    age   income employment_type  ... previous_year_filing  device_type  referral_source
    │                            0   30  45000.0       full_time  ... ...
    └    age   income employment_type  ... previous_year_filing  device_type  referral_source
      0   30  45000.0       full_time  ... ...

  File "/Users/anotherbadcode/Library/Caches/pypoetry/virtualenvs/taxfix-app-9B8dhDvo-py3.11/lib/python3.11/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
              │    │               └ 'sessions_per_minute'
              │    └ <pandas._libs.properties.AxisProperty object at 0x121bf3790>
              └    age   income employment_type  ... previous_year_filing  device_type  referral_source
                0   30  45000.0       full_time  ... ...
  File "/Users/anotherbadcode/Library/Caches/pypoetry/virtualenvs/taxfix-app-9B8dhDvo-py3.11/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
                   └ 'sessions_per_minute'

KeyError: 'sessions_per_minute'
2025-03-10 15:19:11.705 | INFO     | __main__:main:12 - Starting model service
2025-03-10 15:19:11.721 | INFO     | __main__:main:16 - Prediction on test data from config: [1]
2025-03-10 15:19:11.721 | ERROR    | __main__:<module>:29 - An error has been caught in function '<module>', process 'MainProcess' (25707), thread 'MainThread' (8323484672):
Traceback (most recent call last):

> File "/Users/anotherbadcode/Downloads/TaxFix-App/runner.py", line 29, in <module>
    main()
    └ <function main at 0x1001cd1c0>

  File "/Users/anotherbadcode/Downloads/TaxFix-App/runner.py", line 21, in main
    test_df = process_features(test_df)
              └ <function process_features at 0x132b21120>

UnboundLocalError: cannot access local variable 'test_df' where it is not associated with a value
2025-03-10 15:19:42.700 | INFO     | __main__:main:12 - Starting model service
2025-03-10 15:19:42.705 | INFO     | __main__:main:16 - Prediction on test data from config: [1]
2025-03-10 15:19:42.714 | INFO     | __main__:main:26 - Prediction on test json: [1]
2025-03-10 15:24:08.860 | INFO     | __main__:main:12 - Starting model service
2025-03-10 15:24:08.875 | INFO     | __main__:main:16 - Prediction on test data from config: [1]
2025-03-10 15:24:08.878 | INFO     | __main__:main:25 - Prediction on test json: [1]
2025-03-10 15:29:03.460 | INFO     | __main__:main:12 - Starting model service
2025-03-10 15:29:03.475 | INFO     | __main__:main:16 - Prediction on test data from config: [1]
2025-03-10 15:29:03.478 | INFO     | __main__:main:25 - Prediction on test json: [1]
2025-03-10 15:50:54.384 | INFO     | inference:predict:77 - Received Input Data: {'age': 30, 'income': 50000.0, 'employment_type': 'full-time', 'marital_status': 'single', 'time_spent_on_platform': 120.5, 'number_of_sessions': 10, 'fields_filled_percentage': 80.0, 'previous_year_filing': 1, 'device_type': 'mobile', 'referral_source': 'friend'}
2025-03-10 15:50:54.399 | INFO     | inference:process_input:62 - Processed input data:    age   income  ... sessions_per_minute fields_filled_x_sessions
0   30  50000.0  ...                   0                      800

[1 rows x 12 columns]
2025-03-10 15:50:54.399 | ERROR    | inference:predict:84 - Error during prediction: 'DataFrame' object has no attribute 'model_dump'
2025-03-10 15:52:25.192 | INFO     | inference:predict:77 - Received Input Data: age=30 income=50000.0 employment_type='full-time' marital_status='single' time_spent_on_platform=120.5 number_of_sessions=10 fields_filled_percentage=80.0 previous_year_filing=1 device_type='mobile' referral_source='friend'
2025-03-10 15:52:25.201 | INFO     | inference:process_input:62 - Processed input data:    age   income employment_type  ... referral_source  sessions_per_minute  fields_filled_x_sessions
0   30  50000.0       full-time  ...          friend                    0                       800

[1 rows x 12 columns]
2025-03-10 15:52:25.201 | ERROR    | inference:predict:84 - Error during prediction: 'DataFrame' object has no attribute 'model_dump'
2025-03-10 15:53:01.940 | INFO     | inference:predict:77 - Received Input Data: age=30 income=50000.0 employment_type='full-time' marital_status='single' time_spent_on_platform=120.5 number_of_sessions=10 fields_filled_percentage=80.0 previous_year_filing=1 device_type='mobile' referral_source='friend'
2025-03-10 15:53:01.949 | INFO     | inference:process_input:62 - Processed input data:    age   income employment_type  ... referral_source  sessions_per_minute  fields_filled_x_sessions
0   30  50000.0       full-time  ...          friend                    0                       800

[1 rows x 12 columns]
2025-03-10 15:53:01.951 | INFO     | inference:predict:79 - Received processed input:    age   income employment_type  ... referral_source  sessions_per_minute  fields_filled_x_sessions
0   30  50000.0       full-time  ...          friend                    0                       800

[1 rows x 12 columns]
2025-03-10 15:53:02.105 | ERROR    | inference:predict:84 - Error during prediction: Invalid type for cat_feature[non-default value idx=0,feature_idx=1]=50000.0 : cat_features must be integer or string, real number values and NaN values should be converted to string.
2025-03-10 15:55:10.144 | INFO     | inference:predict:77 - Received Input Data: age=30 income=50000.0 employment_type='full-time' marital_status='single' time_spent_on_platform=120.5 number_of_sessions=10 fields_filled_percentage=80.0 previous_year_filing=1 device_type='mobile' referral_source='friend'
2025-03-10 15:55:10.152 | INFO     | inference:process_input:62 - Processed input data:    age   income employment_type  ... referral_source  sessions_per_minute  fields_filled_x_sessions
0   30  50000.0       full-time  ...          friend                    0                       800

[1 rows x 12 columns]
2025-03-10 15:55:10.156 | INFO     | inference:predict:79 - Received processed input:    age   income employment_type  ... referral_source  sessions_per_minute  fields_filled_x_sessions
0   30  50000.0       full-time  ...          friend                    0                       800

[1 rows x 12 columns]
2025-03-10 15:56:12.193 | INFO     | __main__:main:12 - Starting model service
2025-03-10 15:56:12.209 | INFO     | __main__:main:16 - Prediction on test data from config: [1]
2025-03-10 15:56:12.212 | INFO     | __main__:main:25 - Prediction on test json: [1]
2025-03-10 14:57:17.791 | INFO     | inference:predict:77 - Received Input Data: age=30 income=50000.0 employment_type='full-time' marital_status='single' time_spent_on_platform=120.5 number_of_sessions=10 fields_filled_percentage=80.0 previous_year_filing=1 device_type='mobile' referral_source='friend'
2025-03-10 14:57:17.818 | INFO     | inference:process_input:62 - Processed input data:    age   income  ... sessions_per_minute fields_filled_x_sessions
0   30  50000.0  ...                   0                      800

[1 rows x 12 columns]
2025-03-10 14:57:17.823 | INFO     | inference:predict:79 - Received processed input:    age   income  ... sessions_per_minute fields_filled_x_sessions
0   30  50000.0  ...                   0                      800

[1 rows x 12 columns]
